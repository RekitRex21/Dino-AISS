<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Dino-AISS Security Scan</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 40px; background: #f9fafb; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { color: #059669; }
        .score { font-size: 64px; font-weight: bold; }
        .score-high { color: #059669; }
        .score-medium { color: #d97706; }
        .score-low { color: #dc2626; }
        .summary { display: flex; gap: 20px; margin: 20px 0; }
        .stat { background: white; padding: 15px 25px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .critical { color: #dc2626; font-weight: bold; }
        .high { color: #d97706; font-weight: bold; }
        .finding { margin: 15px 0; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #e5e7eb; }
        .finding.critical { border-left-color: #dc2626; }
        .finding.high { border-left-color: #d97706; }
        .finding.medium { border-left-color: #0891b2; }
        .finding.low { border-left-color: #2563eb; }
        .cve { background: #fee2e2; color: #991b1b; padding: 2px 8px; border-radius: 4px; font-size: 12px; }
        code { background: #f3f4f6; padding: 2px 6px; border-radius: 4px; }
        .footer { margin-top: 40px; color: #6b7280; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Dino-AISS Security Scan</h1>
        <p class="score score-low">0</p>
        <div class="summary">
            <div class="stat"><span class="critical">1</span> Critical</div>
            <div class="stat"><span class="high">5</span> High</div>
            <div class="stat">11 Total Findings</div>
        </div>
        
        <h2>Findings</h2>

        <div class="finding critical">
            <h3>Sandbox Mode Disabled </h3>
            <p><strong>Module:</strong> sandbox</p>
            <p><strong>Config Path:</strong> <code>agents.defaults.sandbox.mode</code></p>
            <p><strong>Description:</strong> Sandbox mode is disabled, tools run directly on host</p>
            <p><strong>Remediation:</strong> Enable sandbox mode: agents.defaults.sandbox.mode: 'docker'</p>
        </div>
        <div class="finding high">
            <h3>Potential Secret Detected in Config </h3>
            <p><strong>Module:</strong> credentials</p>
            <p><strong>Config Path:</strong> <code>config</code></p>
            <p><strong>Description:</strong> Found potential secret pattern 'sk-' in configuration</p>
            <p><strong>Remediation:</strong> Review and ensure secrets are properly secured or redacted</p>
        </div>
        <div class="finding high">
            <h3>Tool 'gateway' Not in Deny List </h3>
            <p><strong>Module:</strong> control_plane</p>
            <p><strong>Config Path:</strong> <code>tools.deny</code></p>
            <p><strong>Description:</strong> Gateway tool - can modify config, run updates</p>
            <p><strong>Remediation:</strong> Add 'gateway' to tools.deny</p>
        </div>
        <div class="finding high">
            <h3>Tool 'cron' Not in Deny List </h3>
            <p><strong>Module:</strong> control_plane</p>
            <p><strong>Config Path:</strong> <code>tools.deny</code></p>
            <p><strong>Description:</strong> Cron tool - can schedule jobs</p>
            <p><strong>Remediation:</strong> Add 'cron' to tools.deny</p>
        </div>
        <div class="finding high">
            <h3>Tool 'sessions_spawn' Not in Deny List </h3>
            <p><strong>Module:</strong> control_plane</p>
            <p><strong>Config Path:</strong> <code>tools.deny</code></p>
            <p><strong>Description:</strong> Sessions spawn - can create subagents</p>
            <p><strong>Remediation:</strong> Add 'sessions_spawn' to tools.deny</p>
        </div>
        <div class="finding high">
            <h3>Tool 'sessions_send' Not in Deny List </h3>
            <p><strong>Module:</strong> control_plane</p>
            <p><strong>Config Path:</strong> <code>tools.deny</code></p>
            <p><strong>Description:</strong> Sessions send - can send cross-session messages</p>
            <p><strong>Remediation:</strong> Add 'sessions_send' to tools.deny</p>
        </div>
        <div class="finding medium">
            <h3>Web Fetch SSRF Protection Not Strict <span class='cve'>CVE-2026-26322</span></h3>
            <p><strong>Module:</strong> tools</p>
            <p><strong>Config Path:</strong> <code>tools.webFetch.ssrfPolicy</code></p>
            <p><strong>Description:</strong> web_fetch ssrfPolicy is 'default'</p>
            <p><strong>Remediation:</strong> Set tools.webFetch.ssrfPolicy: 'strict'</p>
        </div>
        <div class="finding medium">
            <h3>Web Search SSRF Protection Not Strict <span class='cve'>CVE-2026-26322</span></h3>
            <p><strong>Module:</strong> tools</p>
            <p><strong>Config Path:</strong> <code>tools.webSearch.ssrfPolicy</code></p>
            <p><strong>Description:</strong> web_search ssrfPolicy is 'default'</p>
            <p><strong>Remediation:</strong> Set tools.webSearch.ssrfPolicy: 'strict'</p>
        </div>
        <div class="finding medium">
            <h3>Gateway Token in Configuration File </h3>
            <p><strong>Module:</strong> credentials</p>
            <p><strong>Config Path:</strong> <code>gateway.auth.token</code></p>
            <p><strong>Description:</strong> Gateway token is stored directly in config file</p>
            <p><strong>Remediation:</strong> Ensure config file has restricted permissions (600)</p>
        </div>
        <div class="finding info">
            <h3>DM Scope Not Explicitly Set </h3>
            <p><strong>Module:</strong> session</p>
            <p><strong>Config Path:</strong> <code>session.dmScope</code></p>
            <p><strong>Description:</strong> session.dmScope defaults to 'main'</p>
            <p><strong>Remediation:</strong> Set session.dmScope explicitly to 'per-channel-peer'</p>
        </div>
        <div class="finding info">
            <h3>Prompt Injection Detection Informational </h3>
            <p><strong>Module:</strong> prompt_injection</p>
            <p><strong>Config Path:</strong> <code>N/A</code></p>
            <p><strong>Description:</strong> This scanner detects configuration paths that could amplify injection impact, not injection itself</p>
            <p><strong>Remediation:</strong> See docs for hardening guidance</p>
        </div>
        <div class="footer">
            <p>Scanned by Dino-AISS v0.1.0 - AI Assistant Security Scanner</p>
            <p>Philosophy: "We scan for real exploit chains, not theoretical configs."</p>
        </div>
    </div>
</body>
</html>